<!DOCTYPE html>
<html lang="en">

http://blog.jchobsononline.ca<head>
  <meta charset="utf-8" >
  <title>Development Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Development Notes" />
  <link href="/assets/css/bootstrap.css" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/font-awesome.css">
  <link href="/assets/css/custom.css" rel="stylesheet" >
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
  <link href='http://fonts.googleapis.com/css?family=Dosis:300,400,500,600,700' rel='stylesheet' type='text/css'>

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <!-- Fav and touch icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="/assets/ico/favicon.png">

  <script src="/assets/js/jquery-2.1.1.js"></script>
  <script src="/assets/js/bootstrap.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="/assets/js/custom.js"></script>

  <!-- google analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-56381209-1', 'auto');
ga('send', 'pageview');
</script>
<!-- end -->


</head>


<body>

  <!-- NAVBAR -->
  <div class="navbar navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-nav">
          <span class="sr-only">Menu</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="http://blog.jchobsononline.ca/index.html" class="navbar-brand">
          <img src="/assets/images/devices-header.png" alt="Loop Logo" />
        </a>
      </div>
      <nav class="navbar-collapse collapse" id="main-nav" role="navigation">
        <ul class="nav navbar-nav nav-text-light">
          <li class="active"><a href="http://blog.jchobsononline.ca/index.html">BLOG HOME</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
  <!-- END NAVBAR -->

  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <article class="post">
          <h2 id="using-google-sheets-as-a-json-data-source">Using Google Sheets as a JSON Data Source</h2>

<h3 id="things-i-have-learned-that-might-help-you">Things I have learned that might help you</h3>

<p>Earlier this year, I developed a Bootstrap based site to list my home for sale by owner. Once that exercise was completed and we have now settled into our new place, I had this idea of converting the site into a template for others. <a href="https://github.com/MrHobbie/Home4Sale2">Link to GitHub repo</a>. There are lots of folks trying to sell their homes, but the resources available to them might not necessarily be directly suited to selling a home.</p>

<p>In planning on what I was going to do, the goal was to make it as easy to modify for someone who had limited web development skills. My first idea was to use a spreadsheet to hold the detailed specification information and then import that into the site. The easiest way I found was to use Google Sheets.  Google Sheets provides for a JSON data source, which should make the task of displaying detailed home specifications simple.</p>

<blockquote>
  <p>Google Sheets provides for a JSON data source</p>
</blockquote>

<p>I had other ideas around how to import the photos using Flickr or other photo sharing services. This idea I will incorporate into a later version of the template.</p>

<p>Of course every project begins with some research (aka Googling) to see what others have done. This proved both useful and frustrating. The useful part showed that it could be done, the frustrating part was that Google had made some changes to their API and the URL’s weren’t exactly the same.</p>

<p>After some good ole fashioned testing and changing one parameter at a time, I got it to go.  The following should prove to be helpful until the spec changes again.</p>

<p>The Google Sheet was setup to mirror the presentation in the website.</p>

<p><img src="/assets/images/2014-12-2/googleSheets.png" alt="Alt &quot;Google Sheets&quot;" title="Google Sheets" /></p>

<p>Note the headings; desc1, data1, etc. These heading names are become JSON field names and are then used to parse the data into the web page table.</p>

<p>With the spreadsheet complete, we need to make it public. (I am not sure what the process is, should you not wish to make your sheet public.) This step can be a little confusing, as there are a number of ways to make a sheet public, but only one way that works for this purpose.</p>

<p>Using the (F)ile menu, then (P)ublish to the Web. The following screen will be displayed:</p>

<p><img src="/assets/images/2014-12-2/googleSheets-2.png" alt="Alt &quot;Google Sheets - Publish&quot;" title="Google Sheets - Publish" /></p>

<p>At this point, you have the option to publish the Entire Document or just a single sheet. Once you have made your selection, click publish.</p>

<p>This screen will be displayed:
<img src="/assets/images/2014-12-2/googleSheets-3.png" alt="Alt &quot;Google Sheets - Share&quot;" title="Google Sheets - Share" /></p>

<p>With this screen displayer, there are a number of options to share this document; Copy the URL as shown, or use one of the social icons shown.</p>

<p>For our purpose of using this Google Sheet as a JSON data source, simply copy the URL as shown.  The URL will look something like:</p>

<pre><code class="html">https://docs.google.com/spreadsheets/d/<strong>1UaWeCOYaX6LUaxw-3EMkcxDd_tJcHVbivQzbou7XETI</strong>/pubhtml</code></pre>

<p>The piece of the URL string that we are interested in, is the long key beginning with ‘1UaW…’, of course yours will be different. This key will be used in the JSON query string.</p>

<h4 id="now-the-magic-happens">Now the Magic Happens</h4>

<h5 id="jquery-function">jQuery Function</h5>
<pre><code class="javascript">
$(function () {  
  $.getJSON("https://spreadsheets.google.com/feeds/list/1UaWeCOYaX6LUaxw-3EMkcxDd_tJcHVbivQzbou7XETI/1/public/values?hl=en_US&amp;alt=json", function( data) {
    var template = $('#spec-template').html();
    var info = Mustache.to_html(template, data.feed);
    $('#datadetails').html(info);
    });
  });
</code></pre>

<p>The JSON call for data is a different URL than we saw earlier.  There are 3 components that I found you need to pay attention to:</p>

<ol>
  <li>The KEY that we copied earlier.</li>
  <li>The number shown after the KEY refers to the number of spreadsheets, should you have more than one. In this case, we only have the one.</li>
  <li>The word ‘values’. The other option I found was ‘basic’.</li>
</ol>

<p>The difference between ‘values’ and ‘basic’, is that ‘values’ parses our the data based on the headings we used in our spreadsheet. I am not going to demo ‘basic’, but you should take a look at the JSON object that is created, just to familiarize yourself.</p>

<p>For Mustache, we specify the code template #spec-template and then the output id #datadetails.</p>

<p>Mustache then converts data into HTML and loops through the JSON object; the HTML page code looks like:</p>

<script src="https://gist.github.com/824af874db3af3a932c1.js"> </script>

<p>To see the complete picture, the CSS code for the table:</p>
<pre><code class="css">
#specDetails {
  height: 100%;
}
#specDetails h2 {
  margin: 70px 0 5px 20px;
}
#specDetails #datadetails {
  margin: 0 20px 0 20px;
}
#specDetails .col1,
#specDetails .col3,
#specDetails .col5 {
  width: 11%;
}
#specDetails .col2,
#specDetails .col4,
#specDetails .col6 {
  width: 22%;
}
#specDetails td {
  text-align: right;
  font-size: .9em;
  padding: 4px 4px 4px 4px;
  border: 1px solid #bbb;
}
#specDetails td.bd {
  font-weight: 600;
  text-align: center;
}
</code></pre>

<p>This proved to be a great solution for streamlining the inclusion of a lot of data without the hassel of editing table tags.</p>

        </article>
        http://blog.jchobsononline.ca<aside class="related">
  <h3>Related Posts</h3>
  <ul class="related-posts">
    
    <li>
      <h4>
         <a href="http://blog.jchobsononline.ca/2014/11/28/writing-a-portfolio-site/">
        <!-- <a href="/2014/11/28/writing-a-portfolio-site/"> -->
          Writing a Portfolio Website
          <small><time datetime="2014-11-28T00:00:00-08:00">28 Nov 2014</time></small>
        </a>
      </h4>
    </li>
    
  </ul>
  
    <hr>
  
</aside>

        http://blog.jchobsononline.ca

  <div id="disqus_thread"></div>
  <script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'johnchobson'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



      </div>
    </div>

    http://blog.jchobsononline.ca<nav  id="footer" class="navbar" role="navigation">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
          <footer>
  <hr>
  <ul class="list-inline social-icon">
    <li><a href="javascript:void(0)" style="color: #a1a1a1; cursor: default;"><i class="fa fa-facebook"></i></a>
    </li>
    <li><a href="https://twitter.com/jchobsononline" target="_blank"><i class="fa fa-twitter"></i></a>
    </li>
    <li><a href="http://jchobsononline.ca/portfolio/index.html#contact"><i class="fa fa-envelope"></i></a>
    </li>
    <li><a href="https://ca.linkedin.com/in/johnchobson" target="_blank"><i class="fa fa-linkedin"></i></a>
    </li>
  </ul>
</footer>

      </div>
    </div>
  </div>
</nav>

  </div>
  <!-- main container div -->

</body>

</html>
